# 企业微信VIP群推送 - 完整指南

## ✨ 功能亮点

- 🎯 **精准推送** - 只推送给VIP群组成员
- 💰 **完全免费** - 无任何费用
- 🔄 **推送无限** - 不限次数
- 👥 **多群支持** - 可同时推送到多个群
- 📊 **内容丰富** - 今日结果+历史趋势+强势股
- 🤖 **全自动** - 每天15:30自动执行并推送

## 📱 效果展示

每天15:30，VIP群会自动收到：

```markdown
# 股票分析结果 2026-02-09

## 📊 今日摘要
- 符合条件股票: **8 只**
- 筛选条件: 成交量≥5倍 且 价格>均线

## 📈 近3日趋势
- 📍 2026-02-09: 8 只
- 📉 2026-02-08: 12 只
- 📈 2026-02-07: 6 只

## ⭐ 连续出现股票（强势）
- 603616 乐凯胶片
- 300666 江特电机

## 💎 今日股票列表

### 1. 603616 乐凯胶片
- 收盘价: 8.29元
- 成交量倍数: **24.12**
- 价格高于均线: 44.93%
...
```

## 🚀 3分钟快速配置

### 步骤1：创建VIP群和机器人（2分钟）

1. 在企业微信创建群聊"股票VIP群"
2. 群里点右上角"..." → "群机器人" → "添加机器人"
3. 复制Webhook地址

### 步骤2：配置程序（1分钟）

编辑 `config/config.ini`：

```ini
[Notification]
enabled = true
push_type = qywechat
qywechat_webhook = 你的Webhook粘贴这里
```

### 步骤3：测试（30秒）

```bash
python test_push.py
```

✅ VIP群立即收到测试消息！

## 🎯 多群配置

### 推送到多个群

同时推送到VIP群、测试群、管理群：

```ini
# 方法1：用逗号分隔
qywechat_webhook = https://qyapi.weixin.qq.com/.../VIP群key,https://qyapi.weixin.qq.com/.../测试群key

# 方法2：用分号分隔
qywechat_webhook = webhook1;webhook2;webhook3
```

**注意**：
- 每个Webhook对应一个群
- 程序会自动向所有群推送
- 至少有一个群推送成功即视为成功

### 群组建议

| 群名称 | 用途 | 成员 |
|--------|------|------|
| 股票VIP群 | 主要推送群 | VIP成员 |
| 股票测试群 | 测试新功能 | 测试人员 |
| 管理通知群 | 系统状态 | 管理员 |

## 📊 推送内容说明

### 1. 今日摘要
- 日期
- 符合条件的股票数量
- 筛选规则

### 2. 近3日趋势
- 显示最近3天的股票数量
- 趋势图标标识（📈📉➡️）
- 帮助判断市场热度

### 3. 连续强势股
- 连续2天都符合条件的股票
- 这些股票势头强劲，重点关注
- 最多显示5只

### 4. 今日股票详情
- 股票代码和名称
- 收盘价和均线
- 成交量倍数（关键指标）
- 价格相对均线涨幅
- 最多显示20只

### 推送逻辑

- ✅ 找到股票时才推送（不骚扰）
- ✅ 按成交量倍数排序（最强的在前）
- ✅ 自动限制长度（避免刷屏）
- ✅ 失败自动重试

## ⚙️ 配置详解

### config/config.ini 完整配置

```ini
[Scheduler]
# 启用定时任务
enabled = true
# 执行时间（收盘后30分钟）
run_time = 15:30
# 只在工作日执行
weekdays_only = true

[Notification]
# 启用推送
enabled = true

# 使用企业微信
push_type = qywechat

# VIP群Webhook（单个群）
qywechat_webhook = https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=你的key

# 或推送到多个群（用逗号分隔）
# qywechat_webhook = webhook1,webhook2,webhook3

# 推送配置
push_history_days = 3   # 显示近3天趋势
push_max_stocks = 20    # 每次最多20只股票
```

## 🔧 Windows自动执行

### 配置任务计划程序

```
1. Win+R → taskschd.msc
2. 创建基本任务
3. 名称：TradeAnalytics VIP群推送
4. 触发：每天 15:30
5. 操作：run_analysis.bat
6. 完成！
```

详细说明：`WINDOWS_SCHEDULER_SUMMARY.md`

### 验证配置

```bash
# 检查任务状态
check_task.bat

# 测试推送
python test_push.py
```

## 👥 VIP群管理

### 添加VIP成员

1. 群聊点击 **"+"**
2. 选择要添加的成员
3. 成员自动收到后续推送

### 移除成员

1. 群聊点击 **"..."** → **"群成员"**
2. 选择成员 → 移除

### 群权限设置

建议设置：
- ✅ 仅群主/管理员可发言（保持群专注）
- ✅ 禁止普通成员@所有人
- ❌ 允许查看历史消息

### 群公告

可以在群公告中说明：
```
欢迎加入股票分析VIP群！

本群每天15:30自动推送：
• 当天成交量暴涨股票（≥5倍）
• 价格在均线之上的股票
• 近3天趋势对比
• 连续强势股标记

推送内容仅供参考，投资需谨慎。
```

## 🎨 自定义推送内容

### 修改推送时间

```ini
[Scheduler]
run_time = 16:00  # 改为下午4点
```

### 修改推送条件

```ini
[Analysis]
volume_ratio_threshold = 10.0  # 改为10倍（更严格）
ma_period = 60  # 改为60日均线
```

### 修改推送数量

```ini
[Notification]
push_max_stocks = 10  # 只推送前10只
push_history_days = 5  # 显示近5天趋势
```

## 💡 使用技巧

### 1. 早盘提醒

可以添加多个定时任务：
- 09:25 - 推送昨日分析结果（早盘参考）
- 15:30 - 推送今日分析结果

### 2. 周末总结

设置周五晚上的总结推送：
- 周五 20:00 - 推送本周汇总

### 3. @提醒重要股票

如果某只股票成交量倍数特别高（如>20倍），可以@所有人：

修改 `src/notification.py`：
```python
# 在特殊情况下@所有人
if max_volume_ratio > 20:
    content = f"<@all>\n\n发现超强势股票！\n\n{content}"
```

### 4. 发送图表

可以将K线图也发送到群里：
```python
# 发送图片到群
# 需要先上传图片获取media_id，然后发送
```

## ⚠️ 注意事项

### 1. Webhook安全

- ⚠️ **保密Webhook** - 不要泄露给非VIP成员
- ⚠️ **不要上传到公开仓库** - config.ini加入.gitignore
- ✅ 如果泄露，立即删除机器人重新创建

### 2. 推送频率

虽然无限制，但建议：
- 每天不超过3次
- 避免骚扰群成员
- 保持内容质量

### 3. 内容质量

- ✅ 只推送符合条件的股票（程序已实现）
- ✅ 添加免责声明
- ✅ 保持内容简洁

## 🔍 故障排查

### 推送失败

**检查清单**：
- [ ] Webhook地址完整（以https开头）
- [ ] 机器人未被删除
- [ ] 网络连接正常
- [ ] 配置文件格式正确（无多余空格）

**测试命令**：
```bash
python test_push.py
```

**查看日志**：
```bash
type logs\notification.log
```

### 定时任务未执行

**检查方法**：
```bash
check_task.bat
```

**手动测试**：
```bash
run_analysis.bat
```

### 多群配置问题

如果多群配置不生效，检查：
- Webhook之间用逗号分隔
- 每个Webhook完整无误
- 没有多余的换行

## 📈 成功案例

### 个人投资者

- 创建1个VIP群，只有自己
- 每天收到分析结果
- 费用：0元

### 投资团队（5人）

- 创建VIP群，5个成员
- 同时推送到测试群（2人）
- 费用：0元

### 投资工作室（20人）

- VIP群：付费客户（10人）
- 内部群：员工讨论（5人）
- 测试群：功能测试（3人）
- 费用：0元

## 📚 文档索引

- **VIP_GROUP_QUICKSTART.md** - 3分钟快速配置（推荐）
- **VIP_GROUP_PUSH_SETUP.md** - 详细配置说明（本文档）
- **WINDOWS_SCHEDULER_SUMMARY.md** - Windows定时任务
- **START_HERE.md** - 总入口文档

## 🎯 下一步

1. ✅ 创建企业微信VIP群
2. ✅ 添加群机器人获取Webhook
3. ✅ 配置 config.ini
4. ✅ 运行 `python test_push.py`
5. ✅ 配置Windows定时任务
6. ✅ 明天15:30等待自动推送

---

**企业微信VIP群推送已配置完成！** 🎉

**完全免费 + 推送无限 + 多群支持 + 全自动** 🚀
